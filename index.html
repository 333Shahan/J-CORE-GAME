<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>J-CORE | Pro 8-Ball</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@900&display=swap');
        body { background: #050010; color: #fff; font-family: 'Montserrat', sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; overflow: hidden; touch-action: none; }
        
        .header { text-align: center; margin-bottom: 10px; z-index: 10; }
        .header h1 { margin: 0; font-size: 1.2rem; background: linear-gradient(45deg, #00ffcc, #ff00a0); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        #container { position: relative; border: 12px solid #3d2b1f; border-radius: 15px; box-shadow: 0 20px 50px #000; width: 360px; height: 180px; background: #006030; }
        canvas { position: absolute; top: 0; left: 0; border-radius: 5px; }

        /* The Cue Stick */
        #cue-stick {
            position: absolute;
            width: 200px;
            height: 6px;
            background: linear-gradient(to right, #3d2b1f 0%, #f4a460 80%, #fff 100%);
            transform-origin: left center;
            pointer-events: none;
            display: none;
            z-index: 20;
            border-radius: 3px;
            box-shadow: 0 5px 10px rgba(0,0,0,0.5);
        }

        .ui { margin-top: 15px; text-align: center; font-size: 10px; color: #00ffcc; letter-spacing: 1px; }
    </style>
</head>
<body>

    <div class="header">
        <h1>J-CORE PRO ARENA</h1>
    </div>

    <div id="container">
        <canvas id="poolCanvas"></canvas>
        <div id="cue-stick"></div>
    </div>

    <div class="ui">
        DRAG AROUND BALL TO AIM â€¢ PULL BACK TO POWER UP<br>
        <span style="color: #ff00a0;">MAHEEN VS JOHAN ðŸ’–</span>
    </div>

    <script>
        const { Engine, Render, Runner, World, Bodies, Body, Vector, Events } = Matter;
        const engine = Engine.create();
        engine.world.gravity.y = 0;

        const canvas = document.getElementById('poolCanvas');
        const ctx = canvas.getContext('2d');
        const stick = document.getElementById('cue-stick');
        const width = 360; const height = 180;
        canvas.width = width; canvas.height = height;

        // Table Walls
        const wallOpt = { isStatic: true, render: { visible: false } };
        World.add(engine.world, [
            Bodies.rectangle(width/2, -10, width, 20, wallOpt),
            Bodies.rectangle(width/2, height+10, width, 20, wallOpt),
            Bodies.rectangle(-10, height/2, 20, height, wallOpt),
            Bodies.rectangle(width+10, height/2, 20, height, wallOpt)
        ]);

        // Balls
        const balls = [];
        const cueBall = Bodies.circle(100, height/2, 8, { restitution: 0.9, frictionAir: 0.015, render: { fillStyle: '#fff' } });
        balls.push(cueBall);

        // Simple Rack
        for(let i=0; i<3; i++) {
            for(let j=0; j<=i; j++) {
                balls.push(Bodies.circle(240 + (i*15), (height/2 - (i*8)) + (j*16), 8, { 
                    restitution: 0.9, frictionAir: 0.015, 
                    render: { fillStyle: (i+j)%2==0 ? '#ffcc00' : '#b22222' } 
                }));
            }
        }
        World.add(engine.world, balls);

        let isAiming = false;
        let angle = 0;
        let power = 0;

        window.addEventListener('mousedown', (e) => { isAiming = true; });
        window.addEventListener('mouseup', (e) => {
            if(isAiming && power > 5) {
                const force = { x: Math.cos(angle) * power * 0.0005, y: Math.sin(angle) * power * 0.0005 };
                Body.applyForce(cueBall, cueBall.position, force);
            }
            isAiming = false;
            power = 0;
            stick.style.display = 'none';
        });

        window.addEventListener('mousemove', (e) => {
            if(!isAiming) return;
            const rect = canvas.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;

            angle = Math.atan2(cueBall.position.y - mouseY, cueBall.position.x - mouseX);
            const dist = Vector.magnitude(Vector.sub(cueBall.position, {x: mouseX, y: mouseY}));
            power = Math.min(dist, 150); // Max power cap

            // Update Stick
            stick.style.display = 'block';
            stick.style.left = cueBall.position.x + 'px';
            stick.style.top = cueBall.position.y + 'px';
            stick.style.transform = `rotate(${angle}rad) translate(${-(power + 20)}px, -3px)`;
        });

        // Animation Loop
        (function update() {
            Engine.update(engine);
            ctx.clearRect(0, 0, width, height);
            
            // Draw Guideline
            if(isAiming) {
                ctx.beginPath();
                ctx.setLineDash([5, 5]);
                ctx.moveTo(cueBall.position.x, cueBall.position.y);
                ctx.lineTo(cueBall.position.x + Math.cos(angle) * 100, cueBall.position.y + Math.sin(angle) * 100);
                ctx.strokeStyle = "rgba(255,255,255,0.3)";
                ctx.stroke();
            }

            balls.forEach(b => {
                ctx.beginPath();
                ctx.arc(b.position.x, b.position.y, 8, 0, Math.PI*2);
                ctx.fillStyle = b.render.fillStyle;
                ctx.fill();
                ctx.closePath();
            });
            requestAnimationFrame(update);
        })();
    </script>
</body>
</html>
