<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>J-CORE | Full Rack Pool</title>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&display=swap');
        body { background: #050010; color: #fff; font-family: 'Montserrat', sans-serif; margin: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; overflow: hidden; }
        
        .game-container { width: 95%; max-width: 420px; background: rgba(15, 0, 30, 0.95); border: 2px solid #ff00a0; border-radius: 20px; padding: 15px; text-align: center; box-shadow: 0 0 40px rgba(255, 0, 160, 0.3); }
        h1 { font-size: 1.5rem; margin: 0; background: linear-gradient(45deg, #00ffcc, #ff00a0); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        /* The Table */
        .pool-table { width: 340px; height: 200px; background: #004d40; border: 10px solid #5d4037; border-radius: 15px; position: relative; margin: 15px auto; box-shadow: inset 0 0 60px #000; }
        .pocket { position: absolute; width: 24px; height: 24px; background: #000; border-radius: 50%; }
        .tl { top: -6px; left: -6px; } .tr { top: -6px; right: -6px; }
        .bl { bottom: -6px; left: -6px; } .br { bottom: -6px; right: -6px; }
        .tc { top: -10px; left: 50%; transform: translateX(-50%); }
        .bc { bottom: -10px; left: 50%; transform: translateX(-50%); }

        /* Ball Styling */
        .ball { position: absolute; width: 14px; height: 14px; border-radius: 50%; transition: all 1.2s cubic-bezier(0.2, 0.8, 0.2, 1); font-size: 7px; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #000; box-shadow: 1px 1px 3px rgba(0,0,0,0.5); }
        .cue { background: #fff; z-index: 10; }
        .solid { background: #ffcc00; } /* Yellows/Reds */
        .stripe { background: #fff; border: 3px solid #ff0055; } /* Striped vibes */
        .eight { background: #000; color: #fff; z-index: 9; }

        /* Controls */
        .btn-shot { background: linear-gradient(45deg, #00ffcc, #009688); border: none; color: white; padding: 12px 35px; border-radius: 50px; font-weight: 900; width: 80%; cursor: pointer; margin-top: 10px; }
        .btn-shot:disabled { background: #333; opacity: 0.6; cursor: not-allowed; }
        
        #turn-info { font-size: 0.7rem; color: #00ffcc; letter-spacing: 2px; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="game-container">
        <h1>J-CORE 8-BALL</h1>
        <div id="turn-info">SYNCING TABLE...</div>

        <div class="pool-table" id="table">
            <div class="pocket tl"></div><div class="pocket tr"></div>
            <div class="pocket tc"></div><div class="pocket bc"></div>
            <div class="pocket bl"></div><div class="pocket br"></div>
            
            <div id="ball-0" class="ball cue"></div>
            </div>

        <button id="shotBtn" class="btn-shot" onclick="takeShot()">SMASH THE RACK ðŸŽ±</button>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAZwCbtIVf4BwXRWuFkkOEPw_Kt3TQGIWc",
            authDomain: "j-core-8eb11.firebaseapp.com",
            projectId: "j-core-8eb11",
            storageBucket: "j-core-8eb11.firebasestorage.app",
            messagingSenderId: "213735832160",
            appId: "1:213735832160:web:a86c2ecc7c5f3f13796105",
            databaseURL: "https://j-core-8eb11-default-rtdb.firebaseio.com/"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        const partnerEmail = "333shahan@gmail.com";

        // Create the balls visually
        const table = document.getElementById('table');
        for(let i=1; i<=15; i++) {
            let b = document.createElement('div');
            b.id = `ball-${i}`;
            b.className = `ball ${i === 8 ? 'eight' : (i < 8 ? 'solid' : 'stripe')}`;
            b.innerText = i;
            table.appendChild(b);
        }

        function syncTable() {
            db.ref('pro_pool').on('value', snap => {
                const data = snap.val();
                if(!data) {
                    // Initial Setup: Rack them up!
                    let initialPositions = { nextTurn: "johan@example.com" }; // Change to your actual login email
                    for(let i=0; i<=15; i++) {
                        initialPositions[`b${i}x`] = i === 0 ? 60 : 200 + (Math.random() * 60);
                        initialPositions[`b${i}y`] = 80 + (Math.random() * 40);
                    }
                    db.ref('pro_pool').set(initialPositions);
                    return;
                }

                // Update all 16 balls
                for(let i=0; i<=15; i++) {
                    const el = document.getElementById(`ball-${i}`);
                    el.style.left = data[`b${i}x`] + 'px';
                    el.style.top = data[`b${i}y`] + 'px';
                }

                const btn = document.getElementById('shotBtn');
                const info = document.getElementById('turn-info');
                // Replace "johan@example.com" with your actual logic
                if(data.nextTurn !== firebase.auth().currentUser.email) {
                    btn.disabled = true;
                    btn.innerText = "WAITING...";
                    info.innerText = "MAHEEN IS AIMING... ðŸ’–";
                } else {
                    btn.disabled = false;
                    btn.innerText = "TAKE YOUR SHOT ðŸŽ±";
                    info.innerText = "YOUR TURN ðŸ”¥";
                }
            });
        }

        function takeShot() {
            document.getElementById('shotBtn').disabled = true;
            let updates = {};
            for(let i=0; i<=15; i++) {
                updates[`b${i}x`] = Math.floor(Math.random() * 280) + 20;
                updates[`b${i}y`] = Math.floor(Math.random() * 140) + 20;
            }
            updates['nextTurn'] = (firebase.auth().currentUser.email === partnerEmail) ? "johan@example.com" : partnerEmail;
            db.ref('pro_pool').update(updates);
        }

        firebase.auth().onAuthStateChanged(user => { if(user) syncTable(); });
    </script>
</body>
</html>
